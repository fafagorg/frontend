[{"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\index.js":"1","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reportWebVitals.js":"2","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\App.js":"3","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reducers\\reducer.js":"4","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\constants\\routes.js":"5","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\index.js":"6","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\NavBar.js":"7","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\profile\\Profile.js":"8","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\products\\Search.js":"9","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\messenger\\Messenger.js":"10","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\home\\Home.js":"11","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\context.js":"12","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\MenuDrawer.js":"13","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\products.js":"14","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\LoginDialog.js":"15","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\messenger.js":"16","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\RegisterDialog.js":"17","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\message\\Message.js":"18","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\room\\Room.js":"19","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\Alert.js":"20","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\product.js":"21","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\newProduct.js":"22","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\auth.js":"23","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\request.js":"24","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\product.js":"25","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\filterProduct.js":"26","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\EditProduct.js":"27","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewList.js":"28","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\clientProducts\\Product.js":"29","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\singleProduct\\Product.js":"30","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\singleProduct.js":"31","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\clientProducts.js":"32","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewsApi.js":"33","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\Alert.js":"34","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\NewReview.js":"35","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\ReviewCard.js":"36"},{"size":1499,"mtime":1610888712323,"results":"37","hashOfConfig":"38"},{"size":377,"mtime":1610888712331,"results":"39","hashOfConfig":"38"},{"size":2261,"mtime":1611509186810,"results":"40","hashOfConfig":"38"},{"size":344,"mtime":1610888712330,"results":"41","hashOfConfig":"38"},{"size":322,"mtime":1611509186814,"results":"42","hashOfConfig":"38"},{"size":98,"mtime":1610888712320,"results":"43","hashOfConfig":"38"},{"size":4746,"mtime":1611528814214,"results":"44","hashOfConfig":"38"},{"size":191,"mtime":1611661916022,"results":"45","hashOfConfig":"38"},{"size":332,"mtime":1610889076941,"results":"46","hashOfConfig":"38"},{"size":12085,"mtime":1611515328386,"results":"47","hashOfConfig":"38"},{"size":1638,"mtime":1611528814252,"results":"48","hashOfConfig":"38"},{"size":297,"mtime":1610888712319,"results":"49","hashOfConfig":"38"},{"size":3406,"mtime":1610888712318,"results":"50","hashOfConfig":"38"},{"size":5269,"mtime":1611661676493,"results":"51","hashOfConfig":"38"},{"size":4587,"mtime":1610888712314,"results":"52","hashOfConfig":"38"},{"size":1443,"mtime":1611515328388,"results":"53","hashOfConfig":"38"},{"size":12034,"mtime":1611070443647,"results":"54","hashOfConfig":"38"},{"size":644,"mtime":1611515328382,"results":"55","hashOfConfig":"38"},{"size":993,"mtime":1610888712318,"results":"56","hashOfConfig":"38"},{"size":465,"mtime":1610889076935,"results":"57","hashOfConfig":"38"},{"size":4390,"mtime":1611659651064,"results":"58","hashOfConfig":"38"},{"size":1584,"mtime":1611659651064,"results":"59","hashOfConfig":"38"},{"size":909,"mtime":1611430413896,"results":"60","hashOfConfig":"38"},{"size":964,"mtime":1610889076945,"results":"61","hashOfConfig":"38"},{"size":1940,"mtime":1611507944793,"results":"62","hashOfConfig":"38"},{"size":2539,"mtime":1611528814230,"results":"63","hashOfConfig":"38"},{"size":1019,"mtime":1611528814219,"results":"64","hashOfConfig":"38"},{"size":3394,"mtime":1611661687818,"results":"65","hashOfConfig":"38"},{"size":349,"mtime":1611430413892,"results":"66","hashOfConfig":"38"},{"size":340,"mtime":1611430413894,"results":"67","hashOfConfig":"38"},{"size":6583,"mtime":1611528814246,"results":"68","hashOfConfig":"38"},{"size":8034,"mtime":1611528814224,"results":"69","hashOfConfig":"38"},{"size":2827,"mtime":1611528814255,"results":"70","hashOfConfig":"38"},{"size":994,"mtime":1611659651065,"results":"71","hashOfConfig":"38"},{"size":2264,"mtime":1611659651066,"results":"72","hashOfConfig":"38"},{"size":4117,"mtime":1611528814248,"results":"73","hashOfConfig":"38"},{"filePath":"74","messages":"75","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},"17mdcm5",{"filePath":"77","messages":"78","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"79","messages":"80","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"81","usedDeprecatedRules":"76"},{"filePath":"82","messages":"83","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"84","messages":"85","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"86","messages":"87","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"88","messages":"89","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"90","messages":"91","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"92","messages":"93","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"94","messages":"95","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"96","usedDeprecatedRules":"76"},{"filePath":"97","messages":"98","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"99","messages":"100","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"101","messages":"102","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"103","messages":"104","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"105","messages":"106","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"107","messages":"108","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"109","messages":"110","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"111","messages":"112","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"113","messages":"114","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"117","messages":"118","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"119","messages":"120","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"121","messages":"122","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"123","messages":"124","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"125","usedDeprecatedRules":"76"},{"filePath":"126","messages":"127","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"128","messages":"129","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"130","messages":"131","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"132","messages":"133","errorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"134","usedDeprecatedRules":"76"},{"filePath":"135","messages":"136","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"137","messages":"138","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"139","messages":"140","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"141","messages":"142","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"143","messages":"144","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"145","messages":"146","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"76"},{"filePath":"147","messages":"148","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"149","usedDeprecatedRules":"76"},{"filePath":"150","messages":"151","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"152","usedDeprecatedRules":"76"},"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\index.js",[],["153","154"],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reportWebVitals.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\App.js",["155"],"import React from \"react\";\r\nimport './App.css';\r\nimport { Router, Route } from \"react-router-dom\";\r\nimport * as ROUTES from \"./constants/routes\";\r\nimport Messenger from \"./pages/messenger/Messenger\";\r\nimport Profile from \"./pages/profile/Profile\";\r\nimport Search from \"./pages/products/Search\";\r\nimport Product from \"./pages/singleProduct/Product\";\r\nimport ClientProducts from \"./pages/clientProducts/Product\";\r\nimport Home from \"./pages/home/Home\";\r\nimport Reviews from \"./pages/reviews/ReviewList\";\r\nimport './bootstrap.min.css';\r\n\r\n\r\nimport NavBar from \"./components/navigation/NavBar\";\r\n\r\nimport { createMuiTheme } from \"@material-ui/core/styles\";\r\nimport { ThemeProvider } from \"@material-ui/styles\";\r\nimport { withHistory } from \"./components/navigation/history\";\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\n\r\n\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      // Purple and green play nicely together.\r\n      main: \"#6800b3\",\r\n      //main: \"#40d0be\", // WP color\r\n    },\r\n    secondary: {\r\n      // This is green.A700 as hex.\r\n      main: \"#ffffff\",\r\n    },\r\n  },\r\n});\r\n\r\nclass App extends React.Component {\r\n  render() {\r\n    return (\r\n      <ThemeProvider theme={theme}>\r\n        <div className=\"App\">\r\n          <NavBar />\r\n          <div className=\"Router\" align=\"center\">\r\n            <Router history={this.props.history}>\r\n              <Route exact path={ROUTES.HOME} component={Home} />\r\n              <Route exact path={ROUTES.SEARCH} component={Search} />\r\n              <Route exact path={ROUTES.PRODUCT} component={Product} />\r\n              <Route exact path={ROUTES.CLIENTPRODUCTS} component={ClientProducts} />\r\n              {this.props.userToken &&\r\n                <>\r\n                  <Route exact path={ROUTES.USER_PROFILE} component={Profile} />\r\n                  <Route path={ROUTES.REVIEWS + \"/:listType\" + \"/:id\"} component={Reviews} />\r\n                  <Route exact path={ROUTES.CHAT} component={Messenger} />\r\n                </>\r\n              }\r\n            </Router>\r\n          </div>\r\n        </div>\r\n      </ThemeProvider>\r\n    );\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    userToken: state.userToken\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(withHistory(App));","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reducers\\reducer.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\constants\\routes.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\index.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\NavBar.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\profile\\Profile.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\products\\Search.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\messenger\\Messenger.js",["156"],"import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport \"./Messenger.css\";\r\nimport { io } from \"socket.io-client\";\r\nimport Message from \"../../components/messenger/message/Message\";\r\nimport Room from \"../../components/messenger/room/Room\";\r\nimport * as MessengerServices from \"../../services/messenger\";\r\nimport { withHistory } from \"../../components/navigation/history\";\r\nimport * as ROUTES from \"../../constants/routes\";\r\nimport { connect } from \"react-redux\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\nclass Messenger extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.roomId = window.location.search.replace(ROUTES.CHAT, '').replace('?roomId=', '') || undefined\r\n    // forbidden if is not your user\r\n    if (this.roomId !== undefined && \r\n      (\r\n        (this.roomId.split('-')[0] !== this.props.data.user.username && this.roomId.split('-')[1] !== this.props.data.user.username) \r\n        || \r\n        this.roomId.split('-')[0] === this.roomId.split('-')[1]\r\n        )\r\n      ) {\r\n      alert('El destinatario no existe');\r\n      this.props.history.push(ROUTES.CHAT);\r\n    }\r\n    \r\n    this.state = { selectedRoomId: this.roomId, rooms: undefined, message: undefined };\r\n    this.content = undefined\r\n\r\n    this.websocket = this.websocket.bind(this);\r\n    this.getRooms = this.getRooms.bind(this);\r\n    this.getMessage = this.getMessage.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.sendMessage = this.sendMessage.bind(this);\r\n    this.changeRoom = this.changeRoom.bind(this);\r\n    this.deleteRoom = this.deleteRoom.bind(this);\r\n    this.modifyRoomName = this.modifyRoomName.bind(this);\r\n  }\r\n\r\n  async componentDidMount() {\r\n    if (this.roomId !== undefined) {\r\n      try {\r\n        await MessengerServices.getMessages(this.roomId, this.props.token);\r\n      } catch(error) {\r\n        if(error.response.data.error === 'Invalid data user'){\r\n          alert('El destinatario no existe');\r\n          this.props.history.push(ROUTES.CHAT);\r\n        }\r\n        if(error.response.data.error === 'Invalid data product'){\r\n          alert('El producto no existe');\r\n          this.props.history.push(ROUTES.CHAT);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.roomId !== undefined) {\r\n      this.setState({ userInfo: await this.getUserInfo(this.getUserDifferent(this.roomId))}) // not work on constructor\r\n    } else {\r\n      this.setState({ userInfo: undefined})\r\n    }\r\n    \r\n    await this.getRooms();\r\n    this.websocket();\r\n  }\r\n\r\n  async getUserInfo(userId){\r\n    try {\r\n      return await MessengerServices.getUserInfo(userId, this.props.token)\r\n    }catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  websocket() {\r\n    this.socket = io(\r\n      process.env.REACT_APP_ENDPOINT_API_MESSENGER + \"/chat\",\r\n      {\r\n        forceNew: false,\r\n        transports: [\"websocket\"],\r\n        query: {\r\n          token: this.props.token,\r\n        },\r\n      }\r\n    );\r\n\r\n    this.socket.on(\"private_message\", async (data) => {\r\n      console.log(this.state)\r\n      if (this.state.selectedRoomId === data.roomId) {\r\n        // new room\r\n        if (this.state.rooms === undefined) {\r\n          let rooms = await MessengerServices.getRooms(this.props.token);\r\n          let message = await MessengerServices.getMessages(this.state.selectedRoomId, this.props.token);\r\n          rooms.map((x) => (x.newMessage = false));\r\n          this.setState({ rooms: rooms, message: message });\r\n        } else {\r\n          // add message and room\r\n          let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n          if (room !== undefined) {\r\n            let message = this.state.message;\r\n            message.messages.push({\r\n              content: data.content,\r\n              userId: data.userId,\r\n            });\r\n\r\n            // new message to false\r\n            room.newMessage = false;\r\n\r\n            this.setState({ message: message, rooms: this.state.rooms });\r\n          }\r\n        }\r\n      } else {\r\n        if(this.state.rooms === undefined) {\r\n          let rooms = await MessengerServices.getRooms(this.props.token);\r\n          let message = await MessengerServices.getMessages(data.roomId, this.props.token);\r\n          this.setState({ rooms: rooms, message: message });\r\n\r\n          let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n          room.newMessage = false;\r\n          this.setState({ rooms: this.state.rooms, selectedRoomId: data.roomId });\r\n        } else {\r\n          // new message to true\r\n          let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n          if (room !== undefined) {\r\n            room.newMessage = true;\r\n            this.setState({ rooms: this.state.rooms });\r\n          } else {\r\n            let rooms = await MessengerServices.getRooms(this.props.token);\r\n            let message = await MessengerServices.getMessages(data.roomId, this.props.token);\r\n            this.setState({ rooms: rooms, message: message });\r\n  \r\n            let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n            room.newMessage = false;\r\n            this.setState({ rooms: this.state.rooms });\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  async getRooms() {\r\n    try {\r\n      let rooms = await MessengerServices.getRooms(this.props.token);\r\n      rooms.map((x) => (x.newMessage = false));\r\n      this.setState({ rooms: rooms });\r\n\r\n      // if exist room, get the once\r\n      if (rooms.length > 0 && this.state.selectedRoomId === undefined) {\r\n        await this.getMessage(rooms[0].roomId);\r\n\r\n        // select once room if I access by /chat url\r\n        this.setState({selectedRoomId: rooms[0].roomId, userInfo: await this.getUserInfo(this.getUserDifferent(rooms[0].roomId))})\r\n      } else if(rooms.length > 0 && this.state.selectedRoomId !== undefined) {\r\n        await this.getMessage(this.state.selectedRoomId);\r\n      } else if(rooms.length === 0) {\r\n        this.setState({message: undefined, rooms: undefined})\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  async getMessage(roomId) {\r\n    try {\r\n      let message = await MessengerServices.getMessages(roomId, this.props.token);\r\n      console.log(message)\r\n      this.setState({ message: message });\r\n    } catch (error) {\r\n      console.log(error.response.data.error)\r\n      if(error.response.data.error === 'Invalid data user'){\r\n        alert('El destinatario no existe');\r\n        this.props.history.push(ROUTES.CHAT);\r\n      }\r\n      if(error.response.data.error === 'Invalid data product'){\r\n        alert('El producto no existe');\r\n        this.props.history.push(ROUTES.CHAT);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.content = event.target.value;\r\n  }\r\n\r\n  getUserDifferent(roomId) {\r\n    if (roomId.split('-')[0] === this.props.data.user.username) {\r\n      return roomId.split('-')[1]\r\n    } else {\r\n      return roomId.split('-')[0]\r\n    }\r\n  }\r\n  async sendMessage() {\r\n    // not undefined content\r\n    if(this.content === undefined || this.content === \"\") return;\r\n\r\n    this.socket.emit(\"send_message\", {\r\n      userId: this.getUserDifferent(this.state.selectedRoomId),\r\n      content: this.content,\r\n      roomId: this.state.selectedRoomId,\r\n    });\r\n    \r\n    // print message\r\n    if (this.state.message !== undefined) {\r\n      this.state.message.messages.push({\r\n        content: this.content,\r\n        userId: this.getUserDifferent(this.state.selectedRoomId),\r\n      })\r\n      this.setState({message: this.state.message})\r\n    }\r\n\r\n    // new conversation\r\n    if (this.state.message === undefined || this.state.message.messages === []) await this.getRooms();\r\n\r\n    // update last message\r\n      // new room\r\n      if (this.state.rooms === undefined) {\r\n        let rooms = await MessengerServices.getRooms(this.props.token);\r\n        let message = await MessengerServices.getMessages(this.state.selectedRoomId, this.props.token);\r\n        rooms.map((x) => (x.newMessage = false));\r\n        this.setState({ rooms: rooms, message: message });\r\n      }\r\n    let room = this.state.rooms.find((x) => x.roomId === this.state.selectedRoomId);\r\n    if (room !== undefined) {\r\n      room.lastMessage = this.content;\r\n      this.setState({ rooms: this.state.rooms });\r\n    }\r\n  }\r\n\r\n  async changeRoom(roomId) {\r\n    await this.getMessage(roomId);\r\n\r\n    // new message to false\r\n    let room = this.state.rooms.find((x) => x.roomId === roomId);\r\n    room.newMessage = false;\r\n\r\n    this.setState({selectedRoomId: roomId, userInfo: await this.getUserInfo(this.getUserDifferent(roomId)), rooms: this.state.rooms})\r\n\r\n    // scroll bottom\r\n    document.getElementById(\"messages\").scrollTop = 10000000000;\r\n  }\r\n\r\n  async deleteRoom(roomId) {\r\n    try {\r\n      await MessengerServices.removeRoom(roomId, this.props.token);\r\n      this.setState({selectedRoomId: undefined, userInfo: undefined})\r\n      await this.getRooms();\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  async modifyRoomName(roomId) {\r\n    let message = this.state.message\r\n    let roomName = prompt(\"Please enter your name\", message.roomName);\r\n\r\n    try {\r\n      await MessengerServices.modifyRoomName(roomId, {roomName: roomName}, this.props.token);\r\n      let rooms = await MessengerServices.getRooms(this.props.token);\r\n\r\n      message.roomName = roomName\r\n      this.setState({rooms: rooms, message: message})\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <link\r\n          rel=\"stylesheet prefetch\"\r\n          href=\"https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css\"\r\n        ></link>\r\n        <link\r\n          rel=\"stylesheet\"\r\n          href=\"https://pro.fontawesome.com/releases/v5.10.0/css/all.css\"\r\n      />\r\n        <div id=\"frame\">\r\n          <div id=\"sidepanel\">\r\n            <div id=\"contacts\">\r\n              <ul>\r\n                {this.state.rooms !== undefined &&\r\n                  this.state.rooms.map((data, i) => (\r\n                    <Room\r\n                      selectedRoomId={\r\n                        data.roomId === this.state.selectedRoomId\r\n                          ? \"selected \"\r\n                          : \"\"\r\n                      }\r\n                      data={data}\r\n                      key={i}\r\n                      changeRoom={this.changeRoom}\r\n                      deleteRoom={this.deleteRoom}\r\n                      modifyRoomName={this.modifyRoomName}\r\n                    />\r\n                  ))}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <div class=\"content\">\r\n            <div class=\"contact-profile\">\r\n              {this.state.userInfo !== undefined && (\r\n                <>\r\n                  <img src={this.state.userInfo.image} alt=\"\" />\r\n                  <p>{this.state.userInfo.userName}</p>\r\n                </>\r\n              )}\r\n            </div>\r\n            <div class=\"messages\" id=\"messages\">\r\n              <ul>\r\n                {this.state.message !== undefined &&\r\n                  this.state.message.messages.map((data, i) => (\r\n                    <Message dataa={data} key={i} />\r\n                  ))}\r\n              </ul>\r\n            </div>\r\n            <div class=\"message-input\">\r\n              <div class=\"wrap\">\r\n                {this.state.selectedRoomId !== undefined ?\r\n                  <>\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Write your message...\"\r\n                      onChange={this.handleChange}\r\n                    />\r\n                    <button class=\"submit\" onClick={() => this.sendMessage()}>\r\n                      <i class=\"fa fa-paper-plane\" aria-hidden=\"true\"></i>\r\n                    </button>\r\n                  </>\r\n                : ''}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nfunction stateToProps(state) {\r\n  return {\r\n    token: state.userToken,\r\n    data: jwt.decode(state.userToken),\r\n  }\r\n}\r\nexport default connect(stateToProps)(withHistory(Messenger));","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\home\\Home.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\context.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\MenuDrawer.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\products.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\LoginDialog.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\messenger.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\RegisterDialog.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\message\\Message.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\room\\Room.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\Alert.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\newProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\auth.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\request.js",["157"],"import axios from \"axios\";\r\nimport Cookies from \"universal-cookie\";\r\n\r\n// request('GET', `${endpoint}/user/${id}`, {}, {}, true);\r\nexport const request = async (method, uri, data, headers, auth = true, token) => {\r\n  if ([\"GET\", \"DELETE\"].includes(method)) {\r\n    uri = serializeUrl(uri, data);\r\n  }\r\n\r\n  if (auth) {\r\n    const access_token = token;\r\n    headers.Authorization = \"Bearer \" + access_token;\r\n  }\r\n\r\n  try {\r\n    let request = await axios.request({\r\n      method: method,\r\n      url: uri,\r\n      data: data,\r\n      headers: headers,\r\n    });\r\n    return request\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst serializeUrl = (uri, params) => {\r\n  const str = [];\r\n\r\n  for (const p in params) {\r\n    if (params.hasOwnProperty(p) && params[p] !== null) {\r\n      str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(params[p]));\r\n    }\r\n  }\r\n\r\n  if (str.length) {\r\n    return uri + \"?\" + str.join(\"&\");\r\n  } else {\r\n    return uri;\r\n  }\r\n};","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\filterProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\EditProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewList.js",["158","159","160","161","162"],"import React from \"react\";\r\n\r\nimport RecipeReviewCard from '../../components/reviews/ReviewCard'\r\nimport Alert from '../../components/reviews/Alert.js';\r\nimport NewReview from '../../components/reviews/NewReview.js';\r\nimport * as ROUTES from \"../../constants/routes\";\r\nimport ReviewsApi from './ReviewsApi.js';\r\nimport { connect } from 'react-redux'\r\n\r\n\r\n\r\n\r\nclass Review extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    const params = window.location.pathname.replace(ROUTES.REVIEWS + '/', '').split('/');\r\n    this.type = params[0] || undefined;\r\n    this.id = params[1] || undefined\r\n\r\n    this.state = {\r\n      errorInfo: null,\r\n      reviews: []\r\n    };\r\n\r\n    this.handleCloseError = this.handleCloseError.bind(this);\r\n    this.addReview = this.addReview.bind(this);\r\n    this.loadReviews = this.loadReviews.bind(this);\r\n  }\r\n\r\n\r\n  async loadReviews() {\r\n    try {\r\n      let result;\r\n      if (this.type === 'client' || this.type === 'product') {\r\n        result = await ReviewsApi.getReviewsByTypeAndId(this.type, this.id);\r\n      }\r\n      else {\r\n        this.setState({\r\n          reviews: [],\r\n          errorInfo: \"Type \" + this.type + \" not compatible\"\r\n        });\r\n        return;\r\n      }\r\n      this.setState({\r\n        reviews: result\r\n      });\r\n    } catch (error) {\r\n      this.setState({\r\n        errorInfo: \"There was a problem with the connection to the server\"\r\n      });\r\n    }\r\n  }\r\n\r\n  async componentDidMount() {\r\n    await this.loadReviews();\r\n  }\r\n\r\n  async addReview(review) {\r\n    if (review.title === '') {\r\n      this.setState({\r\n        errorInfo: \"Title cannot be empty\"\r\n      });\r\n      return false;\r\n    }\r\n    if (review.description === '') {\r\n      this.setState({\r\n        errorInfo: \"Description cannot be empty\"\r\n      });\r\n      return false;\r\n    }\r\n    if (this.type === \"product\") {\r\n      review.reviewedProductId = this.id\r\n    } else if (this.type === \"client\") {\r\n      review.reviewedClientId = this.id\r\n    }\r\n\r\n    if (Number(review.score) < 1 || Number(review.score) > 5) {\r\n      this.setState({\r\n        errorInfo: \"Score must be a number between 1 and 5\"\r\n      });\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      let containBadWords = await ReviewsApi.checkBadWords(review);\r\n      if (!containBadWords) {\r\n        await ReviewsApi.postReview(this.props.userToken, review)\r\n      } else {\r\n        this.setState({\r\n          errorInfo: \"Your review contains bad words. Please be polite.\"\r\n        });\r\n        return false;\r\n      }\r\n\r\n    } catch (error) {\r\n      this.setState({\r\n        errorInfo: \"There was an error adding review\" + error\r\n      });\r\n    }\r\n\r\n    await this.loadReviews();\r\n    return true;\r\n  }\r\n\r\n\r\n\r\n\r\n  handleCloseError() {\r\n    this.setState({\r\n      errorInfo: null\r\n    });\r\n  }\r\n\r\n\r\n  render() {\r\n    var reviewCards = []\r\n    this.state.reviews.forEach(review => {\r\n      reviewCards.push(<RecipeReviewCard review={review}></RecipeReviewCard>)\r\n    })\r\n\r\n    return (\r\n      <>\r\n        <div>\r\n          <Alert message={this.state.errorInfo} onCloseCallback={this.handleCloseError} />\r\n          {reviewCards}\r\n          <br></br>\r\n          <NewReview onAddReview={this.addReview} />\r\n\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    userToken: state.userToken\r\n  }\r\n}\r\nexport default connect(mapStateToProps)(Review);\r\n","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\clientProducts\\Product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\singleProduct\\Product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\singleProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\clientProducts.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewsApi.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\Alert.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\NewReview.js",["163"],"import React from 'react';\r\nimport Rating from '@material-ui/lab/Rating';\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\n\r\n\r\n\r\nclass NewReview extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            title: '',\r\n            score: 1,\r\n            description: ''\r\n        }\r\n\r\n        this.changeReview = this.changeReview.bind(this);\r\n        this.clickAdd = this.clickAdd.bind(this);\r\n        this.setValue = this.setValue.bind(this);\r\n    }\r\n\r\n    changeReview(event) {\r\n        const name = event.target.name;\r\n        const value = event.target.value;\r\n\r\n        this.setState({\r\n            [name]: value\r\n        });\r\n    }\r\n\r\n    async clickAdd() {\r\n        let result = await this.props.onAddReview(this.state);\r\n        if (result) {\r\n            this.setState({\r\n                title: '',\r\n                score: 1,\r\n                description: ''\r\n            });\r\n        }\r\n    }\r\n\r\n    async setValue(newValue){\r\n        this.state.score = newValue\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <table>\r\n                <tr>\r\n                    <th>Title</th>\r\n                    <th>Score</th>\r\n                    <th>Description</th>\r\n\r\n\r\n                    <th>&nbsp;</th>\r\n                    <th>&nbsp;</th>\r\n                </tr>\r\n                <tr>\r\n                    <td><input className=\"form-control\" name=\"title\" value={this.state.title} onChange={this.changeReview}></input></td>\r\n                    <td>\r\n                     \r\n                        <Rating\r\n            name=\"customized-empty\"\r\n            defaultValue={1}\r\n            precision={1}\r\n            onChange={(event, newValue) => {\r\n                this.state.score= newValue\r\n              }}\r\n            emptyIcon={<StarBorderIcon fontSize=\"inherit\" />}\r\n          />\r\n                        </td>\r\n                    <td><input className=\"form-control\" name=\"description\" value={this.state.description} onChange={this.changeReview}></input></td>\r\n                    <td><button data-testid=\"add\" className=\"btn btn-primary\" onClick={this.clickAdd}>Add Review</button></td>\r\n                </tr>\r\n            </table>\r\n        );\r\n    }\r\n}\r\n\r\nexport default NewReview;","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\ReviewCard.js",["164"],"import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport CardMedia from '@material-ui/core/CardMedia';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { red } from '@material-ui/core/colors';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport Rating from '@material-ui/lab/Rating';\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    maxWidth: 1000,\r\n    backgroundColor: '#3405633d',\r\n    marginTop: 10,\r\n    color: 'rgb(0 0 0 0.85)'\r\n  },\r\n  media: {\r\n    height: 200,\r\n    paddingTop: '26.25%', // 16:9\r\n  },\r\n  expand: {\r\n    transform: 'rotate(0deg)',\r\n    marginLeft: 'auto',\r\n    transition: theme.transitions.create('transform', {\r\n      duration: theme.transitions.duration.shortest,\r\n    }),\r\n  },\r\n  expandOpen: {\r\n    transform: 'rotate(180deg)',\r\n  },\r\n  avatar: {\r\n    backgroundColor: red[500],\r\n  },\r\n}));\r\n\r\nexport default function RecipeReviewCard(props) {\r\n  const review = props.review\r\n  let reviewIcon = '';\r\n\r\n  const classes = useStyles();\r\n  const [expanded, setExpanded] = React.useState(false);\r\n\r\n  const handleExpandClick = () => {\r\n    setExpanded(!expanded);\r\n  };\r\n\r\n  var comments = []\r\n  for (const comment of review.comments) {\r\n    comments.push(<Typography paragraph>{comment.clientId}</Typography>)\r\n    comments.push(<Typography paragraph>{comment.body} </Typography>);\r\n  }\r\n\r\n  if (review.externalScore === 'Neutral'){\r\n    reviewIcon = \"😐\";\r\n  } else if (review.externalScore === 'Positive'){\r\n    reviewIcon = \"😀\";\r\n  } else if (review.externalScore === 'Verypositive'){\r\n    reviewIcon = \"🥳\";\r\n  } else  if (review.externalScore === 'Negative'){\r\n    reviewIcon = \"😠\";\r\n  } else  if (review.externalScore === 'Verynegative'){\r\n    reviewIcon = \"💩\";\r\n  } else {\r\n    reviewIcon = \"👽\";\r\n  }\r\n\r\n  return (\r\n    <Card className={classes.root}>\r\n\r\n      <CardHeader\r\n        avatar={\r\n          <Avatar aria-label=\"recipe\" className={classes.avatar}>\r\n             {review.reviewerClientId.substring(0,1).toUpperCase()}{review.reviewerClientId.substring(1,2)}\r\n          </Avatar>\r\n       \r\n        }\r\n        \r\n        action={\r\n          <div>\r\n          <Rating\r\n            name=\"customized-empty\"\r\n            defaultValue={4}\r\n            value={review.score}\r\n            readOnly={true}\r\n            precision={1}\r\n            emptyIcon={<StarBorderIcon fontSize=\"inherit\" />}\r\n          />\r\n         <br></br>\r\n         {reviewIcon}\r\n          </div>\r\n        }\r\n        \r\n        title={review.title}\r\n        subheader={new Intl.DateTimeFormat(\"en-GB\", {\r\n          year: \"numeric\",\r\n          month: \"long\",\r\n          day: \"2-digit\"\r\n        }).format(new Date(review.dateCreated))}>\r\n\r\n\r\n      </CardHeader>\r\n      {/* <CardMedia\r\n        className={classes.media}\r\n        image=\"/static/images/cards/paella.png\"\r\n        title=\"Paella dish\"\r\n      /> */}\r\n      <CardContent>\r\n        <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\r\n          {review.description}\r\n        </Typography>\r\n      </CardContent>\r\n      <CardActions disableSpacing>\r\n\r\n\r\n        <IconButton\r\n          className={clsx(classes.expand, {\r\n            [classes.expandOpen]: expanded,\r\n          })}\r\n          onClick={handleExpandClick}\r\n          aria-expanded={expanded}\r\n          aria-label=\"show more\"\r\n        >\r\n          {review.comments.length} comments\r\n          <ExpandMoreIcon />\r\n\r\n        </IconButton>\r\n\r\n      </CardActions>\r\n      <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n        <CardContent>\r\n          {comments}\r\n        </CardContent>\r\n      </Collapse>\r\n    </Card>\r\n  );\r\n}",{"ruleId":"165","replacedBy":"166"},{"ruleId":"167","replacedBy":"168"},{"ruleId":"169","severity":1,"message":"170","line":55,"column":62,"nodeType":"171","messageId":"172","endLine":55,"endColumn":63},{"ruleId":"173","severity":1,"message":"174","line":2,"column":10,"nodeType":"175","messageId":"176","endLine":2,"endColumn":14},{"ruleId":"173","severity":1,"message":"177","line":2,"column":8,"nodeType":"175","messageId":"176","endLine":2,"endColumn":15},{"ruleId":"173","severity":1,"message":"178","line":15,"column":7,"nodeType":"175","messageId":"176","endLine":15,"endColumn":19},{"ruleId":"179","severity":1,"message":"180","line":49,"column":21,"nodeType":"171","messageId":"181","endLine":49,"endColumn":23},{"ruleId":"179","severity":1,"message":"180","line":49,"column":46,"nodeType":"171","messageId":"181","endLine":49,"endColumn":48},{"ruleId":"179","severity":1,"message":"180","line":86,"column":19,"nodeType":"171","messageId":"181","endLine":86,"endColumn":21},{"ruleId":"179","severity":1,"message":"180","line":88,"column":26,"nodeType":"171","messageId":"181","endLine":88,"endColumn":28},{"ruleId":"182","severity":1,"message":"183","line":67,"column":17,"nodeType":"184","endLine":67,"endColumn":27},{"ruleId":"173","severity":1,"message":"185","line":6,"column":8,"nodeType":"175","messageId":"176","endLine":6,"endColumn":17},"no-native-reassign",["186"],"no-negated-in-lhs",["187"],"no-useless-concat","Unexpected string concatenation of literals.","BinaryExpression","unexpectedConcat","no-unused-vars","'Link' is defined but never used.","Identifier","unusedVar","'Cookies' is defined but never used.","'StyledRating' is assigned a value but never used.","eqeqeq","Expected '===' and instead saw '=='.","unexpected","react/no-direct-mutation-state","Do not mutate state directly. Use setState().","MemberExpression","'CardMedia' is defined but never used.","no-global-assign","no-unsafe-negation"]