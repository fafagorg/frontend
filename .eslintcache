[{"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\index.js":"1","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reportWebVitals.js":"2","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\App.js":"3","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reducers\\reducer.js":"4","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\constants\\routes.js":"5","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\index.js":"6","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\NavBar.js":"7","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\profile\\Profile.js":"8","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\products\\Search.js":"9","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\messenger\\Messenger.js":"10","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\home\\Home.js":"11","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\context.js":"12","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\MenuDrawer.js":"13","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\products.js":"14","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\LoginDialog.js":"15","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\messenger.js":"16","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\RegisterDialog.js":"17","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\message\\Message.js":"18","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\room\\Room.js":"19","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\Alert.js":"20","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\product.js":"21","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\newProduct.js":"22","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\auth.js":"23","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\request.js":"24","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\product.js":"25","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\filterProduct.js":"26","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\EditProduct.js":"27","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewList.js":"28","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\clientProducts\\Product.js":"29","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\singleProduct\\Product.js":"30","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\singleProduct.js":"31","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\clientProducts.js":"32","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewsApi.js":"33","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\Alert.js":"34","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\NewReview.js":"35","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\ReviewCard.js":"36","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\profile\\ProfileApi.js":"37","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\NewComment.js":"38","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\EditReview.js":"39"},{"size":1499,"mtime":1610888712323,"results":"40","hashOfConfig":"41"},{"size":377,"mtime":1610888712331,"results":"42","hashOfConfig":"41"},{"size":2478,"mtime":1611713693641,"results":"43","hashOfConfig":"41"},{"size":432,"mtime":1611692220908,"results":"44","hashOfConfig":"41"},{"size":363,"mtime":1611713693644,"results":"45","hashOfConfig":"41"},{"size":98,"mtime":1610888712320,"results":"46","hashOfConfig":"41"},{"size":4645,"mtime":1611739238752,"results":"47","hashOfConfig":"41"},{"size":6645,"mtime":1611741442239,"results":"48","hashOfConfig":"41"},{"size":332,"mtime":1610889076941,"results":"49","hashOfConfig":"41"},{"size":12085,"mtime":1611515328386,"results":"50","hashOfConfig":"41"},{"size":2328,"mtime":1611739598122,"results":"51","hashOfConfig":"41"},{"size":297,"mtime":1610888712319,"results":"52","hashOfConfig":"41"},{"size":3406,"mtime":1610888712318,"results":"53","hashOfConfig":"41"},{"size":5269,"mtime":1611692162719,"results":"54","hashOfConfig":"41"},{"size":4667,"mtime":1611692220904,"results":"55","hashOfConfig":"41"},{"size":1443,"mtime":1611515328388,"results":"56","hashOfConfig":"41"},{"size":12112,"mtime":1611739238740,"results":"57","hashOfConfig":"41"},{"size":648,"mtime":1611739238745,"results":"58","hashOfConfig":"41"},{"size":993,"mtime":1610888712318,"results":"59","hashOfConfig":"41"},{"size":465,"mtime":1610889076935,"results":"60","hashOfConfig":"41"},{"size":4398,"mtime":1611692162717,"results":"61","hashOfConfig":"41"},{"size":1643,"mtime":1611739238763,"results":"62","hashOfConfig":"41"},{"size":909,"mtime":1611430413896,"results":"63","hashOfConfig":"41"},{"size":964,"mtime":1610889076945,"results":"64","hashOfConfig":"41"},{"size":1940,"mtime":1611507944793,"results":"65","hashOfConfig":"41"},{"size":2539,"mtime":1611665762863,"results":"66","hashOfConfig":"41"},{"size":1019,"mtime":1611665762848,"results":"67","hashOfConfig":"41"},{"size":4499,"mtime":1611739937741,"results":"68","hashOfConfig":"41"},{"size":349,"mtime":1611430413892,"results":"69","hashOfConfig":"41"},{"size":340,"mtime":1611430413894,"results":"70","hashOfConfig":"41"},{"size":6583,"mtime":1611665762874,"results":"71","hashOfConfig":"41"},{"size":8046,"mtime":1611739238757,"results":"72","hashOfConfig":"41"},{"size":3581,"mtime":1611713693648,"results":"73","hashOfConfig":"41"},{"size":994,"mtime":1611665762876,"results":"74","hashOfConfig":"41"},{"size":2264,"mtime":1611665762877,"results":"75","hashOfConfig":"41"},{"size":4589,"mtime":1611713693643,"results":"76","hashOfConfig":"41"},{"size":526,"mtime":1611692220908,"results":"77","hashOfConfig":"41"},{"size":1459,"mtime":1611713693642,"results":"78","hashOfConfig":"41"},{"size":3144,"mtime":1611740209010,"results":"79","hashOfConfig":"41"},{"filePath":"80","messages":"81","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},"17mdcm5",{"filePath":"83","messages":"84","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"85","messages":"86","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"87","usedDeprecatedRules":"82"},{"filePath":"88","messages":"89","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"90","messages":"91","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"92","messages":"93","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"94","messages":"95","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"96","messages":"97","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"98","messages":"99","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"100","messages":"101","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"102","usedDeprecatedRules":"82"},{"filePath":"103","messages":"104","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"105","messages":"106","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"107","messages":"108","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"109","messages":"110","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"111","messages":"112","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"113","messages":"114","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"115","messages":"116","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"117","messages":"118","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"119","messages":"120","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"121","messages":"122","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"123","messages":"124","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"125","messages":"126","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"127","messages":"128","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"129","messages":"130","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"131","usedDeprecatedRules":"82"},{"filePath":"132","messages":"133","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"134","messages":"135","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"136","messages":"137","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"138","messages":"139","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"140","messages":"141","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"142","messages":"143","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"144","messages":"145","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"146","messages":"147","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"148","messages":"149","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"150","messages":"151","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"152","messages":"153","errorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"154","usedDeprecatedRules":"82"},{"filePath":"155","messages":"156","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"157","usedDeprecatedRules":"82"},{"filePath":"158","messages":"159","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"160","messages":"161","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"82"},{"filePath":"162","messages":"163","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\index.js",[],["164","165"],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reportWebVitals.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\App.js",["166"],"import React from \"react\";\r\nimport './App.css';\r\nimport { Router, Route } from \"react-router-dom\";\r\nimport * as ROUTES from \"./constants/routes\";\r\nimport Messenger from \"./pages/messenger/Messenger\";\r\nimport Profile from \"./pages/profile/Profile\";\r\nimport Search from \"./pages/products/Search\";\r\nimport Product from \"./pages/singleProduct/Product\";\r\nimport ClientProducts from \"./pages/clientProducts/Product\";\r\nimport Home from \"./pages/home/Home\";\r\nimport Reviews from \"./pages/reviews/ReviewList\";\r\nimport EditReview from \"./pages/reviews/EditReview\";\r\nimport './bootstrap.min.css';\r\n\r\n\r\nimport NavBar from \"./components/navigation/NavBar\";\r\n\r\nimport { createMuiTheme } from \"@material-ui/core/styles\";\r\nimport { ThemeProvider } from \"@material-ui/styles\";\r\nimport { withHistory } from \"./components/navigation/history\";\r\n\r\n// Redux\r\nimport { connect } from 'react-redux'\r\n\r\n\r\n\r\nconst theme = createMuiTheme({\r\n  palette: {\r\n    primary: {\r\n      // Purple and green play nicely together.\r\n      main: \"#6800b3\",\r\n      //main: \"#40d0be\", // WP color\r\n    },\r\n    secondary: {\r\n      // This is green.A700 as hex.\r\n      main: \"#ffffff\",\r\n    },\r\n  },\r\n});\r\n\r\nclass App extends React.Component {\r\n  render() {\r\n    return (\r\n      <ThemeProvider theme={theme}>\r\n        <div className=\"App\">\r\n          <NavBar />\r\n          <div className=\"Router\" align=\"center\">\r\n            <Router history={this.props.history}>\r\n              <Route exact path={ROUTES.HOME} component={Home} />\r\n              <Route exact path={ROUTES.SEARCH} component={Search} />\r\n              <Route exact path={ROUTES.PRODUCT} component={Product} />\r\n              <Route exact path={ROUTES.CLIENTPRODUCTS} component={ClientProducts} />\r\n              <Route path={ROUTES.REVIEWS + \"/:listType\" + \"/:id\"} component={Reviews} />\r\n              <Route path={ROUTES.USER_PROFILE + \"/:id\"} component={Profile} />\r\n              {this.props.userToken &&\r\n                <>\r\n                  <Route exact path={ROUTES.USER_PROFILE} component={Profile} />\r\n                  <Route path={ROUTES.EDITREVIEW + \"/:id\"} component={EditReview} />\r\n                  <Route exact path={ROUTES.CHAT} component={Messenger} />\r\n                </>\r\n              }\r\n            </Router>\r\n          </div>\r\n        </div>\r\n      </ThemeProvider>\r\n    );\r\n  }\r\n}\r\n\r\nfunction mapStateToProps(state) {\r\n  return {\r\n    userToken: state.userToken\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps)(withHistory(App));","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\reducers\\reducer.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\constants\\routes.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\index.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\NavBar.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\profile\\Profile.js",["167","168","169","170"],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\products\\Search.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\messenger\\Messenger.js",["171"],"import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport \"./Messenger.css\";\r\nimport { io } from \"socket.io-client\";\r\nimport Message from \"../../components/messenger/message/Message\";\r\nimport Room from \"../../components/messenger/room/Room\";\r\nimport * as MessengerServices from \"../../services/messenger\";\r\nimport { withHistory } from \"../../components/navigation/history\";\r\nimport * as ROUTES from \"../../constants/routes\";\r\nimport { connect } from \"react-redux\";\r\nimport jwt from \"jsonwebtoken\";\r\n\r\nclass Messenger extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.roomId = window.location.search.replace(ROUTES.CHAT, '').replace('?roomId=', '') || undefined\r\n    // forbidden if is not your user\r\n    if (this.roomId !== undefined && \r\n      (\r\n        (this.roomId.split('-')[0] !== this.props.data.user.username && this.roomId.split('-')[1] !== this.props.data.user.username) \r\n        || \r\n        this.roomId.split('-')[0] === this.roomId.split('-')[1]\r\n        )\r\n      ) {\r\n      alert('El destinatario no existe');\r\n      this.props.history.push(ROUTES.CHAT);\r\n    }\r\n    \r\n    this.state = { selectedRoomId: this.roomId, rooms: undefined, message: undefined };\r\n    this.content = undefined\r\n\r\n    this.websocket = this.websocket.bind(this);\r\n    this.getRooms = this.getRooms.bind(this);\r\n    this.getMessage = this.getMessage.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.sendMessage = this.sendMessage.bind(this);\r\n    this.changeRoom = this.changeRoom.bind(this);\r\n    this.deleteRoom = this.deleteRoom.bind(this);\r\n    this.modifyRoomName = this.modifyRoomName.bind(this);\r\n  }\r\n\r\n  async componentDidMount() {\r\n    if (this.roomId !== undefined) {\r\n      try {\r\n        await MessengerServices.getMessages(this.roomId, this.props.token);\r\n      } catch(error) {\r\n        if(error.response.data.error === 'Invalid data user'){\r\n          alert('El destinatario no existe');\r\n          this.props.history.push(ROUTES.CHAT);\r\n        }\r\n        if(error.response.data.error === 'Invalid data product'){\r\n          alert('El producto no existe');\r\n          this.props.history.push(ROUTES.CHAT);\r\n        }\r\n      }\r\n    }\r\n\r\n    if (this.roomId !== undefined) {\r\n      this.setState({ userInfo: await this.getUserInfo(this.getUserDifferent(this.roomId))}) // not work on constructor\r\n    } else {\r\n      this.setState({ userInfo: undefined})\r\n    }\r\n    \r\n    await this.getRooms();\r\n    this.websocket();\r\n  }\r\n\r\n  async getUserInfo(userId){\r\n    try {\r\n      return await MessengerServices.getUserInfo(userId, this.props.token)\r\n    }catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  websocket() {\r\n    this.socket = io(\r\n      process.env.REACT_APP_ENDPOINT_API_MESSENGER + \"/chat\",\r\n      {\r\n        forceNew: false,\r\n        transports: [\"websocket\"],\r\n        query: {\r\n          token: this.props.token,\r\n        },\r\n      }\r\n    );\r\n\r\n    this.socket.on(\"private_message\", async (data) => {\r\n      console.log(this.state)\r\n      if (this.state.selectedRoomId === data.roomId) {\r\n        // new room\r\n        if (this.state.rooms === undefined) {\r\n          let rooms = await MessengerServices.getRooms(this.props.token);\r\n          let message = await MessengerServices.getMessages(this.state.selectedRoomId, this.props.token);\r\n          rooms.map((x) => (x.newMessage = false));\r\n          this.setState({ rooms: rooms, message: message });\r\n        } else {\r\n          // add message and room\r\n          let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n          if (room !== undefined) {\r\n            let message = this.state.message;\r\n            message.messages.push({\r\n              content: data.content,\r\n              userId: data.userId,\r\n            });\r\n\r\n            // new message to false\r\n            room.newMessage = false;\r\n\r\n            this.setState({ message: message, rooms: this.state.rooms });\r\n          }\r\n        }\r\n      } else {\r\n        if(this.state.rooms === undefined) {\r\n          let rooms = await MessengerServices.getRooms(this.props.token);\r\n          let message = await MessengerServices.getMessages(data.roomId, this.props.token);\r\n          this.setState({ rooms: rooms, message: message });\r\n\r\n          let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n          room.newMessage = false;\r\n          this.setState({ rooms: this.state.rooms, selectedRoomId: data.roomId });\r\n        } else {\r\n          // new message to true\r\n          let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n          if (room !== undefined) {\r\n            room.newMessage = true;\r\n            this.setState({ rooms: this.state.rooms });\r\n          } else {\r\n            let rooms = await MessengerServices.getRooms(this.props.token);\r\n            let message = await MessengerServices.getMessages(data.roomId, this.props.token);\r\n            this.setState({ rooms: rooms, message: message });\r\n  \r\n            let room = this.state.rooms.find((x) => x.roomId === data.roomId);\r\n            room.newMessage = false;\r\n            this.setState({ rooms: this.state.rooms });\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  async getRooms() {\r\n    try {\r\n      let rooms = await MessengerServices.getRooms(this.props.token);\r\n      rooms.map((x) => (x.newMessage = false));\r\n      this.setState({ rooms: rooms });\r\n\r\n      // if exist room, get the once\r\n      if (rooms.length > 0 && this.state.selectedRoomId === undefined) {\r\n        await this.getMessage(rooms[0].roomId);\r\n\r\n        // select once room if I access by /chat url\r\n        this.setState({selectedRoomId: rooms[0].roomId, userInfo: await this.getUserInfo(this.getUserDifferent(rooms[0].roomId))})\r\n      } else if(rooms.length > 0 && this.state.selectedRoomId !== undefined) {\r\n        await this.getMessage(this.state.selectedRoomId);\r\n      } else if(rooms.length === 0) {\r\n        this.setState({message: undefined, rooms: undefined})\r\n      }\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  }\r\n\r\n  async getMessage(roomId) {\r\n    try {\r\n      let message = await MessengerServices.getMessages(roomId, this.props.token);\r\n      console.log(message)\r\n      this.setState({ message: message });\r\n    } catch (error) {\r\n      console.log(error.response.data.error)\r\n      if(error.response.data.error === 'Invalid data user'){\r\n        alert('El destinatario no existe');\r\n        this.props.history.push(ROUTES.CHAT);\r\n      }\r\n      if(error.response.data.error === 'Invalid data product'){\r\n        alert('El producto no existe');\r\n        this.props.history.push(ROUTES.CHAT);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.content = event.target.value;\r\n  }\r\n\r\n  getUserDifferent(roomId) {\r\n    if (roomId.split('-')[0] === this.props.data.user.username) {\r\n      return roomId.split('-')[1]\r\n    } else {\r\n      return roomId.split('-')[0]\r\n    }\r\n  }\r\n  async sendMessage() {\r\n    // not undefined content\r\n    if(this.content === undefined || this.content === \"\") return;\r\n\r\n    this.socket.emit(\"send_message\", {\r\n      userId: this.getUserDifferent(this.state.selectedRoomId),\r\n      content: this.content,\r\n      roomId: this.state.selectedRoomId,\r\n    });\r\n    \r\n    // print message\r\n    if (this.state.message !== undefined) {\r\n      this.state.message.messages.push({\r\n        content: this.content,\r\n        userId: this.getUserDifferent(this.state.selectedRoomId),\r\n      })\r\n      this.setState({message: this.state.message})\r\n    }\r\n\r\n    // new conversation\r\n    if (this.state.message === undefined || this.state.message.messages === []) await this.getRooms();\r\n\r\n    // update last message\r\n      // new room\r\n      if (this.state.rooms === undefined) {\r\n        let rooms = await MessengerServices.getRooms(this.props.token);\r\n        let message = await MessengerServices.getMessages(this.state.selectedRoomId, this.props.token);\r\n        rooms.map((x) => (x.newMessage = false));\r\n        this.setState({ rooms: rooms, message: message });\r\n      }\r\n    let room = this.state.rooms.find((x) => x.roomId === this.state.selectedRoomId);\r\n    if (room !== undefined) {\r\n      room.lastMessage = this.content;\r\n      this.setState({ rooms: this.state.rooms });\r\n    }\r\n  }\r\n\r\n  async changeRoom(roomId) {\r\n    await this.getMessage(roomId);\r\n\r\n    // new message to false\r\n    let room = this.state.rooms.find((x) => x.roomId === roomId);\r\n    room.newMessage = false;\r\n\r\n    this.setState({selectedRoomId: roomId, userInfo: await this.getUserInfo(this.getUserDifferent(roomId)), rooms: this.state.rooms})\r\n\r\n    // scroll bottom\r\n    document.getElementById(\"messages\").scrollTop = 10000000000;\r\n  }\r\n\r\n  async deleteRoom(roomId) {\r\n    try {\r\n      await MessengerServices.removeRoom(roomId, this.props.token);\r\n      this.setState({selectedRoomId: undefined, userInfo: undefined})\r\n      await this.getRooms();\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  async modifyRoomName(roomId) {\r\n    let message = this.state.message\r\n    let roomName = prompt(\"Please enter your name\", message.roomName);\r\n\r\n    try {\r\n      await MessengerServices.modifyRoomName(roomId, {roomName: roomName}, this.props.token);\r\n      let rooms = await MessengerServices.getRooms(this.props.token);\r\n\r\n      message.roomName = roomName\r\n      this.setState({rooms: rooms, message: message})\r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <link\r\n          rel=\"stylesheet prefetch\"\r\n          href=\"https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css\"\r\n        ></link>\r\n        <link\r\n          rel=\"stylesheet\"\r\n          href=\"https://pro.fontawesome.com/releases/v5.10.0/css/all.css\"\r\n      />\r\n        <div id=\"frame\">\r\n          <div id=\"sidepanel\">\r\n            <div id=\"contacts\">\r\n              <ul>\r\n                {this.state.rooms !== undefined &&\r\n                  this.state.rooms.map((data, i) => (\r\n                    <Room\r\n                      selectedRoomId={\r\n                        data.roomId === this.state.selectedRoomId\r\n                          ? \"selected \"\r\n                          : \"\"\r\n                      }\r\n                      data={data}\r\n                      key={i}\r\n                      changeRoom={this.changeRoom}\r\n                      deleteRoom={this.deleteRoom}\r\n                      modifyRoomName={this.modifyRoomName}\r\n                    />\r\n                  ))}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n          <div class=\"content\">\r\n            <div class=\"contact-profile\">\r\n              {this.state.userInfo !== undefined && (\r\n                <>\r\n                  <img src={this.state.userInfo.image} alt=\"\" />\r\n                  <p>{this.state.userInfo.userName}</p>\r\n                </>\r\n              )}\r\n            </div>\r\n            <div class=\"messages\" id=\"messages\">\r\n              <ul>\r\n                {this.state.message !== undefined &&\r\n                  this.state.message.messages.map((data, i) => (\r\n                    <Message dataa={data} key={i} />\r\n                  ))}\r\n              </ul>\r\n            </div>\r\n            <div class=\"message-input\">\r\n              <div class=\"wrap\">\r\n                {this.state.selectedRoomId !== undefined ?\r\n                  <>\r\n                    <input\r\n                      type=\"text\"\r\n                      placeholder=\"Write your message...\"\r\n                      onChange={this.handleChange}\r\n                    />\r\n                    <button class=\"submit\" onClick={() => this.sendMessage()}>\r\n                      <i class=\"fa fa-paper-plane\" aria-hidden=\"true\"></i>\r\n                    </button>\r\n                  </>\r\n                : ''}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nfunction stateToProps(state) {\r\n  return {\r\n    token: state.userToken,\r\n    data: jwt.decode(state.userToken),\r\n  }\r\n}\r\nexport default connect(stateToProps)(withHistory(Messenger));","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\home\\Home.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\history\\context.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\navigation\\MenuDrawer.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\products.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\LoginDialog.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\messenger.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\auth\\RegisterDialog.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\message\\Message.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\messenger\\room\\Room.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\Alert.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\newProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\auth.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\request.js",["172"],"import axios from \"axios\";\r\nimport Cookies from \"universal-cookie\";\r\n\r\n// request('GET', `${endpoint}/user/${id}`, {}, {}, true);\r\nexport const request = async (method, uri, data, headers, auth = true, token) => {\r\n  if ([\"GET\", \"DELETE\"].includes(method)) {\r\n    uri = serializeUrl(uri, data);\r\n  }\r\n\r\n  if (auth) {\r\n    const access_token = token;\r\n    headers.Authorization = \"Bearer \" + access_token;\r\n  }\r\n\r\n  try {\r\n    let request = await axios.request({\r\n      method: method,\r\n      url: uri,\r\n      data: data,\r\n      headers: headers,\r\n    });\r\n    return request\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n};\r\n\r\nconst serializeUrl = (uri, params) => {\r\n  const str = [];\r\n\r\n  for (const p in params) {\r\n    if (params.hasOwnProperty(p) && params[p] !== null) {\r\n      str.push(encodeURIComponent(p) + \"=\" + encodeURIComponent(params[p]));\r\n    }\r\n  }\r\n\r\n  if (str.length) {\r\n    return uri + \"?\" + str.join(\"&\");\r\n  } else {\r\n    return uri;\r\n  }\r\n};","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\services\\product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\filterProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\EditProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewList.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\clientProducts\\Product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\singleProduct\\Product.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\singleProduct.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\product\\clientProducts.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\ReviewsApi.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\Alert.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\NewReview.js",["173"],"import React from 'react';\r\nimport Rating from '@material-ui/lab/Rating';\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\n\r\n\r\n\r\nclass NewReview extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.state = {\r\n            title: '',\r\n            score: 1,\r\n            description: ''\r\n        }\r\n\r\n        this.changeReview = this.changeReview.bind(this);\r\n        this.clickAdd = this.clickAdd.bind(this);\r\n        this.setValue = this.setValue.bind(this);\r\n    }\r\n\r\n    changeReview(event) {\r\n        const name = event.target.name;\r\n        const value = event.target.value;\r\n\r\n        this.setState({\r\n            [name]: value\r\n        });\r\n    }\r\n\r\n    async clickAdd() {\r\n        let result = await this.props.onAddReview(this.state);\r\n        if (result) {\r\n            this.setState({\r\n                title: '',\r\n                score: 1,\r\n                description: ''\r\n            });\r\n        }\r\n    }\r\n\r\n    async setValue(newValue){\r\n        this.state.score = newValue\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <table>\r\n                <tr>\r\n                    <th>Title</th>\r\n                    <th>Score</th>\r\n                    <th>Description</th>\r\n\r\n\r\n                    <th>&nbsp;</th>\r\n                    <th>&nbsp;</th>\r\n                </tr>\r\n                <tr>\r\n                    <td><input className=\"form-control\" name=\"title\" value={this.state.title} onChange={this.changeReview}></input></td>\r\n                    <td>\r\n                     \r\n                        <Rating\r\n            name=\"customized-empty\"\r\n            defaultValue={1}\r\n            precision={1}\r\n            onChange={(event, newValue) => {\r\n                this.state.score= newValue\r\n              }}\r\n            emptyIcon={<StarBorderIcon fontSize=\"inherit\" />}\r\n          />\r\n                        </td>\r\n                    <td><input className=\"form-control\" name=\"description\" value={this.state.description} onChange={this.changeReview}></input></td>\r\n                    <td><button data-testid=\"add\" className=\"btn btn-primary\" onClick={this.clickAdd}>Add Review</button></td>\r\n                </tr>\r\n            </table>\r\n        );\r\n    }\r\n}\r\n\r\nexport default NewReview;","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\ReviewCard.js",["174","175","176"],"import React from 'react';\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport clsx from 'clsx';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport CardMedia from '@material-ui/core/CardMedia';\r\nimport CardContent from '@material-ui/core/CardContent';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport Collapse from '@material-ui/core/Collapse';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport { red } from '@material-ui/core/colors';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport Rating from '@material-ui/lab/Rating';\r\nimport StarBorderIcon from '@material-ui/icons/StarBorder';\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  root: {\r\n    maxWidth: 1000,\r\n    backgroundColor: '#3405633d',\r\n    marginTop: 10,\r\n    color: 'rgb(0 0 0 0.85)'\r\n  },\r\n  media: {\r\n    height: 200,\r\n    paddingTop: '26.25%', // 16:9\r\n  },\r\n  expand: {\r\n    transform: 'rotate(0deg)',\r\n    marginLeft: 'auto',\r\n    transition: theme.transitions.create('transform', {\r\n      duration: theme.transitions.duration.shortest,\r\n    }),\r\n  },\r\n  expandOpen: {\r\n    transform: 'rotate(180deg)',\r\n  },\r\n  avatar: {\r\n    backgroundColor: red[500],\r\n  },\r\n}));\r\n\r\nexport default function RecipeReviewCard(props) {\r\n  const review = props.review\r\n  let reviewIcon = '';\r\n\r\n  const classes = useStyles();\r\n  const [expanded, setExpanded] = React.useState(false);\r\n\r\n  const handleExpandClick = () => {\r\n    setExpanded(!expanded);\r\n  };\r\n\r\n  var comments = []\r\n  for (const comment of review.comments) {\r\n    comments.push(<Typography paragraph>{comment.clientId}</Typography>)\r\n    comments.push(<Typography paragraph>{comment.body} </Typography>);\r\n  }\r\n\r\n  if (review.externalScore === 'Neutral'){\r\n    reviewIcon = \"üòê\";\r\n  } else if (review.externalScore === 'Positive'){\r\n    reviewIcon = \"üòÄ\";\r\n  } else if (review.externalScore === 'Verypositive'){\r\n    reviewIcon = \"ü•≥\";\r\n  } else  if (review.externalScore === 'Negative'){\r\n    reviewIcon = \"üò†\";\r\n  } else  if (review.externalScore === 'Verynegative'){\r\n    reviewIcon = \"üí©\";\r\n  } else {\r\n    reviewIcon = \"üëΩ\";\r\n  }\r\n\r\n  return (\r\n    <Card className={classes.root}>\r\n\r\n      <CardHeader\r\n        avatar={\r\n          <Avatar aria-label=\"recipe\" className={classes.avatar}>\r\n             {review.reviewerClientId.substring(0,1).toUpperCase()}{review.reviewerClientId.substring(1,2)}\r\n          </Avatar>\r\n       \r\n        }\r\n        \r\n        action={\r\n          <div>\r\n          <Rating\r\n            name=\"customized-empty\"\r\n            defaultValue={4}\r\n            value={review.score}\r\n            readOnly={true}\r\n            precision={1}\r\n            emptyIcon={<StarBorderIcon fontSize=\"inherit\" />}\r\n          />\r\n         <br></br>\r\n         {reviewIcon}\r\n          </div>\r\n        }\r\n        \r\n        title={review.title}\r\n        subheader={new Intl.DateTimeFormat(\"en-GB\", {\r\n          year: \"numeric\",\r\n          month: \"long\",\r\n          day: \"2-digit\"\r\n        }).format(new Date(review.dateCreated))}>\r\n\r\n\r\n      </CardHeader>\r\n      {/* <CardMedia\r\n        className={classes.media}\r\n        image=\"/static/images/cards/paella.png\"\r\n        title=\"Paella dish\"\r\n      /> */}\r\n      <CardContent>\r\n        <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\r\n          {review.description}\r\n        </Typography>\r\n      </CardContent>\r\n      <CardActions disableSpacing>\r\n\r\n\r\n        <IconButton\r\n          className={clsx(classes.expand, {\r\n            [classes.expandOpen]: expanded,\r\n          })}\r\n          onClick={handleExpandClick}\r\n          aria-expanded={expanded}\r\n          aria-label=\"show more\"\r\n        >\r\n          {review.comments.length} comments\r\n          <ExpandMoreIcon />\r\n\r\n        </IconButton>\r\n\r\n      </CardActions>\r\n      <Collapse in={expanded} timeout=\"auto\" unmountOnExit>\r\n        <CardContent>\r\n          {comments}\r\n        </CardContent>\r\n      </Collapse>\r\n    </Card>\r\n  );\r\n}","E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\profile\\ProfileApi.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\components\\reviews\\NewComment.js",[],"E:\\Universidad\\FundamentosSof\\Repositorios\\frontend\\src\\pages\\reviews\\EditReview.js",["177","178","179"],{"ruleId":"180","replacedBy":"181"},{"ruleId":"182","replacedBy":"183"},{"ruleId":"184","severity":1,"message":"185","line":53,"column":58,"nodeType":"186","messageId":"187","endLine":53,"endColumn":59},{"ruleId":"188","severity":1,"message":"189","line":8,"column":8,"nodeType":"190","messageId":"191","endLine":8,"endColumn":13},{"ruleId":"188","severity":1,"message":"192","line":10,"column":8,"nodeType":"190","messageId":"191","endLine":10,"endColumn":12},{"ruleId":"188","severity":1,"message":"193","line":11,"column":8,"nodeType":"190","messageId":"191","endLine":11,"endColumn":19},{"ruleId":"188","severity":1,"message":"194","line":12,"column":8,"nodeType":"190","messageId":"191","endLine":12,"endColumn":19},{"ruleId":"188","severity":1,"message":"195","line":2,"column":10,"nodeType":"190","messageId":"191","endLine":2,"endColumn":14},{"ruleId":"188","severity":1,"message":"196","line":2,"column":8,"nodeType":"190","messageId":"191","endLine":2,"endColumn":15},{"ruleId":"197","severity":1,"message":"198","line":67,"column":17,"nodeType":"199","endLine":67,"endColumn":27},{"ruleId":"188","severity":1,"message":"200","line":6,"column":8,"nodeType":"190","messageId":"191","endLine":6,"endColumn":17},{"ruleId":"201","severity":1,"message":"202","line":59,"column":7,"nodeType":"203","endLine":59,"endColumn":60},{"ruleId":"204","severity":1,"message":"205","line":59,"column":15,"nodeType":"206","messageId":"207","endLine":59,"endColumn":28},{"ruleId":"188","severity":1,"message":"208","line":52,"column":15,"nodeType":"190","messageId":"191","endLine":52,"endColumn":21},{"ruleId":"188","severity":1,"message":"209","line":58,"column":18,"nodeType":"190","messageId":"191","endLine":58,"endColumn":24},{"ruleId":"197","severity":1,"message":"198","line":83,"column":25,"nodeType":"199","endLine":83,"endColumn":40},"no-native-reassign",["210"],"no-negated-in-lhs",["211"],"no-useless-concat","Unexpected string concatenation of literals.","BinaryExpression","unexpectedConcat","no-unused-vars","'Paper' is defined but never used.","Identifier","unusedVar","'Card' is defined but never used.","'CardActions' is defined but never used.","'CardContent' is defined but never used.","'Link' is defined but never used.","'Cookies' is defined but never used.","react/no-direct-mutation-state","Do not mutate state directly. Use setState().","MemberExpression","'CardMedia' is defined but never used.","jsx-a11y/anchor-is-valid","The href attribute requires a valid value to be accessible. Provide a valid, navigable address as the href value. If you cannot provide a valid href, but still need the element to resemble a link, use a button and change it with appropriate styles. Learn more: https://github.com/evcohen/eslint-plugin-jsx-a11y/blob/master/docs/rules/anchor-is-valid.md","JSXOpeningElement","no-script-url","Script URL is a form of eval.","Literal","unexpectedScriptURL","'result' is assigned a value but never used.","'goBack' is defined but never used.","no-global-assign","no-unsafe-negation"]